"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6567],{28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>l});var s=t(96540);const i={},r=s.createContext(i);function a(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(r.Provider,{value:n},e.children)}},31749:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"testing/debugging-pattern-matching","title":"Debugging Pattern Matching","description":"When patterns fail to match during automation, Brobot provides several powerful debugging tools to help identify and resolve issues.","source":"@site/docs/04-testing/debugging-pattern-matching.md","sourceDirName":"04-testing","slug":"/testing/debugging-pattern-matching","permalink":"/brobot/docs/testing/debugging-pattern-matching","draft":false,"unlisted":false,"editUrl":"https://github.com/jspinak/brobot/edit/main/docs/docs/04-testing/debugging-pattern-matching.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"docSidebar","previous":{"title":"Mixed-Mode Execution","permalink":"/brobot/docs/testing/mixed-mode-execution"},"next":{"title":"Hybrid Architecture Summary","permalink":"/brobot/docs/testing/hybrid-architecture-summary"}}');var i=t(74848),r=t(28453);const a={sidebar_position:5},l="Debugging Pattern Matching",o={},c=[{value:"Best Match Capture",id:"best-match-capture",level:2},{value:"How It Works",id:"how-it-works",level:3},{value:"Configuration",id:"configuration",level:3},{value:"Output Format",id:"output-format",level:3},{value:"Console Output",id:"console-output",level:3},{value:"Use Cases",id:"use-cases",level:3},{value:"Analyzing Captured Images",id:"analyzing-captured-images",level:3},{value:"Progressive Similarity Testing",id:"progressive-similarity-testing",level:2},{value:"Console Output",id:"console-output-1",level:3},{value:"Debug Image Saving",id:"debug-image-saving",level:2},{value:"Image Analysis",id:"image-analysis",level:2},{value:"Verbosity Levels",id:"verbosity-levels",level:2},{value:"Troubleshooting Common Issues",id:"troubleshooting-common-issues",level:2},{value:"Pattern Not Found at Expected Similarity",id:"pattern-not-found-at-expected-similarity",level:3},{value:"Black or Invalid Screen Captures",id:"black-or-invalid-screen-captures",level:3},{value:"Patterns Match in Wrong Location",id:"patterns-match-in-wrong-location",level:3},{value:"Best Practices",id:"best-practices",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"debugging-pattern-matching",children:"Debugging Pattern Matching"})}),"\n",(0,i.jsx)(n.p,{children:"When patterns fail to match during automation, Brobot provides several powerful debugging tools to help identify and resolve issues."}),"\n",(0,i.jsx)(n.h2,{id:"best-match-capture",children:"Best Match Capture"}),"\n",(0,i.jsx)(n.p,{children:"The Best Match Capture feature helps debug pattern matching failures by capturing and saving the region that best matches your pattern, even when it doesn't meet the similarity threshold."}),"\n",(0,i.jsx)(n.h3,{id:"how-it-works",children:"How It Works"}),"\n",(0,i.jsx)(n.p,{children:"When enabled, the Best Match Capture system:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Detects when pattern searches fail or find low-similarity matches"}),"\n",(0,i.jsx)(n.li,{children:"Performs a search at very low threshold (0.1) to find any potential match"}),"\n",(0,i.jsx)(n.li,{children:"Captures the best matching region from the screen"}),"\n",(0,i.jsx)(n.li,{children:"Saves both the matched region and original pattern for comparison"}),"\n",(0,i.jsx)(n.li,{children:"Names files with timestamp and similarity score for easy tracking"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["Add these properties to your ",(0,i.jsx)(n.code,{children:"application.properties"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-properties",children:"# Enable best match capture\nbrobot.debug.capture-best-match=true\n\n# Only capture when match is below this threshold (default: 0.95)\nbrobot.debug.capture-threshold=0.95\n\n# Directory to save captured images (relative to project root)\nbrobot.debug.capture-directory=history/best-matches\n\n# Also save the pattern image for comparison (default: true)\nbrobot.debug.save-pattern-image=true\n"})}),"\n",(0,i.jsx)(n.h3,{id:"output-format",children:"Output Format"}),"\n",(0,i.jsx)(n.p,{children:"Captured images are saved with descriptive filenames:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Match image"}),": ",(0,i.jsx)(n.code,{children:"YYYYMMDD-HHmmss_PatternName_sim###_match.png"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Pattern image"}),": ",(0,i.jsx)(n.code,{children:"YYYYMMDD-HHmmss_PatternName_sim###_pattern.png"})]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"history/best-matches/\n\u251c\u2500\u2500 20250810-143022_claude-prompt-1_sim045_match.png\n\u251c\u2500\u2500 20250810-143022_claude-prompt-1_sim045_pattern.png\n\u251c\u2500\u2500 20250810-143025_submit-button_sim062_match.png\n\u2514\u2500\u2500 20250810-143025_submit-button_sim062_pattern.png\n"})}),"\n",(0,i.jsx)(n.h3,{id:"console-output",children:"Console Output"}),"\n",(0,i.jsx)(n.p,{children:"When a best match is captured, you'll see console messages like:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[BEST_MATCH] Captured best match for 'claude-prompt-1' with similarity 0.453 saved to: history/best-matches/20250810-143022_claude-prompt-1_sim453_match.png\n[BEST_MATCH] Pattern image saved to: history/best-matches/20250810-143022_claude-prompt-1_sim453_pattern.png\n"})}),"\n",(0,i.jsx)(n.h3,{id:"use-cases",children:"Use Cases"}),"\n",(0,i.jsx)(n.p,{children:"This feature is particularly useful for:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Understanding Match Failures"}),": Compare what the pattern looks like vs what was actually found"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Similarity Threshold Tuning"}),": See the actual similarity scores to adjust thresholds"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"UI Changes Detection"}),": Identify when the UI has changed slightly (fonts, colors, scaling)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Resolution Issues"}),": Detect when patterns fail due to different screen resolutions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Alpha Channel Issues"}),": Identify transparency-related matching problems"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"analyzing-captured-images",children:"Analyzing Captured Images"}),"\n",(0,i.jsx)(n.p,{children:"When analyzing captured images:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Compare visually"}),": Open both pattern and match images side-by-side"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Check for differences"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Color variations (especially with dark/light themes)"}),"\n",(0,i.jsx)(n.li,{children:"Font rendering differences"}),"\n",(0,i.jsx)(n.li,{children:"Scaling or resolution mismatches"}),"\n",(0,i.jsx)(n.li,{children:"Anti-aliasing artifacts"}),"\n",(0,i.jsx)(n.li,{children:"Transparency/alpha channel issues"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Adjust patterns based on findings"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Update pattern images if UI has changed"}),"\n",(0,i.jsx)(n.li,{children:"Adjust similarity thresholds if minor variations are acceptable"}),"\n",(0,i.jsx)(n.li,{children:"Consider using multiple pattern variations"}),"\n",(0,i.jsx)(n.li,{children:"Remove alpha channels if causing issues"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"progressive-similarity-testing",children:"Progressive Similarity Testing"}),"\n",(0,i.jsx)(n.p,{children:"In addition to best match capture, Brobot automatically performs progressive similarity testing when patterns fail. This tests the pattern at decreasing thresholds to find the minimum similarity at which it would match."}),"\n",(0,i.jsx)(n.h3,{id:"console-output-1",children:"Console Output"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[SIMILARITY DEBUG] Testing pattern 'claude-prompt-1'\n[SIMILARITY DEBUG] Original MinSimilarity: 0.7\n[SIMILARITY ANALYSIS]\n  Threshold 0.5: FOUND with score 0.523\n"})}),"\n",(0,i.jsx)(n.p,{children:"This tells you exactly what similarity threshold would be needed for the pattern to match."}),"\n",(0,i.jsx)(n.h2,{id:"debug-image-saving",children:"Debug Image Saving"}),"\n",(0,i.jsx)(n.p,{children:'When patterns with "prompt" in their name fail to match, Brobot automatically saves debug images to help diagnose the issue:'}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"debug_images/\n\u251c\u2500\u2500 pattern_claude-prompt-1.png\n\u251c\u2500\u2500 pattern_claude-prompt-2.png\n\u2514\u2500\u2500 scene_current.png\n"})}),"\n",(0,i.jsx)(n.h2,{id:"image-analysis",children:"Image Analysis"}),"\n",(0,i.jsx)(n.p,{children:"Brobot provides automatic image content analysis to detect common issues:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[IMAGE ANALYSIS]\n  Pattern: 293x83 type=ARGB bytes=97KB\n  Pattern content: 5.2% black, 0.3% white, avg RGB=(45,45,48)\n  Scene: 1920x1080 type=RGB bytes=8MB\n  Scene content: 92.1% black, 0.1% white, avg RGB=(12,12,12)\n  WARNING: Scene is mostly BLACK - possible capture failure!\n"})}),"\n",(0,i.jsx)(n.h2,{id:"verbosity-levels",children:"Verbosity Levels"}),"\n",(0,i.jsx)(n.p,{children:"Control the amount of debug information with verbosity settings:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-properties",children:"# Set to VERBOSE for maximum debug information\nbrobot.logging.verbosity=VERBOSE\nbrobot.console.actions.level=VERBOSE\n\n# Enable specific debug logging\nlogging.level.io.github.jspinak.brobot.action.internal.find=DEBUG\n"})}),"\n",(0,i.jsx)(n.h2,{id:"troubleshooting-common-issues",children:"Troubleshooting Common Issues"}),"\n",(0,i.jsx)(n.h3,{id:"pattern-not-found-at-expected-similarity",children:"Pattern Not Found at Expected Similarity"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptoms"}),": Pattern matches at 0.5 but threshold is 0.7"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Enable best match capture to see what's being matched"}),"\n",(0,i.jsx)(n.li,{children:"Check for alpha channel issues (transparent backgrounds)"}),"\n",(0,i.jsx)(n.li,{children:"Verify color space consistency (RGB vs ARGB)"}),"\n",(0,i.jsx)(n.li,{children:"Consider UI theme differences (dark vs light mode)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"black-or-invalid-screen-captures",children:"Black or Invalid Screen Captures"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptoms"}),": Scene images are all black or invalid"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Check display permissions and settings"}),"\n",(0,i.jsx)(n.li,{children:"Verify not running in true headless mode"}),"\n",(0,i.jsx)(n.li,{children:"For WSL2, ensure X11 forwarding is configured"}),"\n",(0,i.jsxs)(n.li,{children:["Check ",(0,i.jsx)(n.code,{children:"DISPLAY"})," environment variable"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"patterns-match-in-wrong-location",children:"Patterns Match in Wrong Location"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Symptoms"}),": Patterns found but in unexpected screen areas"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Solutions"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Define search regions to limit search area"}),"\n",(0,i.jsx)(n.li,{children:"Check for duplicate UI elements"}),"\n",(0,i.jsx)(n.li,{children:"Increase similarity threshold"}),"\n",(0,i.jsx)(n.li,{children:"Use fixed regions for consistent UI elements"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Always enable during development"}),": Keep best match capture enabled while developing patterns"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Review captured images regularly"}),": Check the history folder to understand matching behavior"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Clean up periodically"}),": Delete old captures to save disk space"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Use meaningful pattern names"}),": Makes captured files easier to identify"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Adjust thresholds based on captures"}),": Use actual similarity scores to set appropriate thresholds"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);