<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-testing/actionhistory-integration-testing" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">ActionHistory Integration Testing | Brobot</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://jspinak.github.io/brobot/docs/testing/actionhistory-integration-testing"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ActionHistory Integration Testing | Brobot"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/brobot/img/brobot-happy.ico"><link data-rh="true" rel="canonical" href="https://jspinak.github.io/brobot/docs/testing/actionhistory-integration-testing"><link data-rh="true" rel="alternate" href="https://jspinak.github.io/brobot/docs/testing/actionhistory-integration-testing" hreflang="en"><link data-rh="true" rel="alternate" href="https://jspinak.github.io/brobot/docs/testing/actionhistory-integration-testing" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"ActionHistory Integration Testing","item":"https://jspinak.github.io/brobot/docs/testing/actionhistory-integration-testing"}]}</script><link rel="alternate" type="application/rss+xml" href="/brobot/blog/rss.xml" title="Brobot RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/brobot/blog/atom.xml" title="Brobot Atom Feed">




<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-6WY1S6ZWEY"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-6WY1S6ZWEY",{anonymize_ip:!0})</script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" integrity="sha384-GvrOXuhMATgEsSwCs4smul74iXGOixntILdUW9XmUC6+HX0sLNAK3q71HotJqlAn" crossorigin="anonymous"><link rel="stylesheet" href="/brobot/assets/css/styles.1b22d91f.css">
<script src="/brobot/assets/js/runtime~main.5b553c8b.js" defer="defer"></script>
<script src="/brobot/assets/js/main.c217fb38.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/brobot/"><div class="navbar__logo"><img src="/brobot/img/brobot_logo/brobot-happy-text.svg" alt="Brobot Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/brobot/img/brobot_logo/brobot-happy-text.svg" alt="Brobot Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Brobot</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/brobot/docs/getting-started/introduction">Documentation</a><a href="https://jspinak.github.io/brobot/api/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API Reference<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a class="navbar__item navbar__link" href="/brobot/visualAPI">The Visual API</a><a class="navbar__item navbar__link" href="/brobot/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/brobot/docs/testing/actionhistory-integration-testing">Latest</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/brobot/docs/testing/actionhistory-integration-testing">Latest</a></li><li><a class="dropdown__link" href="/brobot/docs/1.0.7/getting-started/introduction">1.0.7</a></li><li><a class="dropdown__link" href="/brobot/docs/1.0.6/introduction">1.0.6</a></li></ul></div><a href="https://github.com/jspinak/brobot" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/brobot/docs/getting-started/introduction">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/brobot/docs/no-code-automation/desktop-runner/runner-overview">No-Code Automation (Beta)</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/brobot/docs/core-library/guides/finding-objects/configuration-note">Core Library (for Developers)</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/brobot/docs/testing/testing-intro">Testing Your Automation</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/brobot/docs/testing/testing-intro">Testing Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/brobot/docs/testing/integration-testing">Integration Testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/brobot/docs/testing/mock-mode-guide">Mock Mode Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/brobot/docs/testing/actionhistory-mock-snapshots">ActionHistory and Mock Snapshots</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/brobot/docs/testing/mock-mode-manager">Mock Mode Manager</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/brobot/docs/testing/profile-based-architecture">Profile-Based Architecture</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/brobot/docs/testing/unit-testing">Unit Testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/brobot/docs/testing/action-recording">Action Recording</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/brobot/docs/testing/actionhistory-integration-testing">ActionHistory Integration Testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/brobot/docs/testing/mixed-mode-execution">Mixed-Mode Execution</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/brobot/docs/testing/debugging-pattern-matching">Debugging Pattern Matching</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/brobot/docs/testing/hybrid-architecture-summary">Hybrid Architecture Summary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/brobot/docs/testing/profile-based-testing">Profile-Based Testing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/brobot/docs/testing/test-utilities">Test Utilities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/brobot/docs/testing/mock-mode-migration">Mock Mode Migration Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/brobot/docs/testing/TESTING_STRATEGY">Brobot Testing Strategy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/brobot/docs/testing/mat-testing-utilities">Mat Testing Utilities</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/brobot/docs/migration/frameworksettings-to-brobotproperties">migration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/brobot/docs/category/theoretical-foundations">Theoretical Foundations</a><button aria-label="Expand sidebar category &#x27;Theoretical Foundations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/brobot/docs/category/integrations">Integrations</a><button aria-label="Expand sidebar category &#x27;Integrations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/brobot/docs/logging">Logging</a><button aria-label="Expand sidebar category &#x27;Logging&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/brobot/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Testing Your Automation</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">ActionHistory Integration Testing</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Latest</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>ActionHistory Integration Testing</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p>ActionHistory is the core component of Brobot&#x27;s mock testing framework, enabling realistic simulation of GUI automation without requiring the actual application. It maintains a statistical model of how GUI elements behave, capturing not just whether elements were found but also when, where, and under what conditions.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="understanding-actionhistory">Understanding ActionHistory<a href="#understanding-actionhistory" class="hash-link" aria-label="Direct link to Understanding ActionHistory" title="Direct link to Understanding ActionHistory">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-actionhistory">What is ActionHistory?<a href="#what-is-actionhistory" class="hash-link" aria-label="Direct link to What is ActionHistory?" title="Direct link to What is ActionHistory?">​</a></h3>
<p>ActionHistory is a data structure that accumulates <code>ActionRecord</code> snapshots over time, building a probabilistic model of GUI behavior. This historical data serves two critical purposes:</p>
<ol>
<li><strong>Mock Execution</strong>: Enables realistic testing without the target application</li>
<li><strong>Pattern Learning</strong>: Provides empirical data for optimizing automation strategies</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-components">Key Components<a href="#key-components" class="hash-link" aria-label="Direct link to Key Components" title="Direct link to Key Components">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class ActionHistory {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private int timesSearched = 0;      // Total search attempts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private int timesFound = 0;         // Successful finds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private List&lt;ActionRecord&gt; snapshots = new ArrayList&lt;&gt;();  // Historical records</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>Each <code>ActionRecord</code> contains:</p>
<ul>
<li><strong>ActionConfig</strong>: The action configuration (modern API)</li>
<li><strong>Match Results</strong>: Screenshot regions where patterns were found</li>
<li><strong>Success Status</strong>: Whether the action succeeded</li>
<li><strong>Timing Data</strong>: Duration and timestamps</li>
<li><strong>Context</strong>: State and environment information</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="modern-api-usage">Modern API Usage<a href="#modern-api-usage" class="hash-link" aria-label="Direct link to Modern API Usage" title="Direct link to Modern API Usage">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-actionhistory-with-actionconfig">Creating ActionHistory with ActionConfig<a href="#creating-actionhistory-with-actionconfig" class="hash-link" aria-label="Direct link to Creating ActionHistory with ActionConfig" title="Direct link to Creating ActionHistory with ActionConfig">​</a></h3>
<p>The modern API uses strongly-typed <code>ActionConfig</code> classes instead of the deprecated <code>ActionOptions</code>:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import io.github.jspinak.brobot.model.action.ActionHistory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import io.github.jspinak.brobot.model.action.ActionRecord;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import io.github.jspinak.brobot.action.basic.find.PatternFindOptions;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import io.github.jspinak.brobot.model.match.Match;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Create an ActionHistory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ActionHistory history = new ActionHistory();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Add a find action record</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ActionRecord findRecord = new ActionRecord.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .setActionConfig(new PatternFindOptions.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .setStrategy(PatternFindOptions.Strategy.BEST)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .setSimilarity(0.95)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .build())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .addMatch(new Match.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .setRegion(100, 200, 50, 30)  // x, y, width, height</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .setSimScore(0.96)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .build())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .setActionSuccess(true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .setDuration(250)  // milliseconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">history.addSnapshot(findRecord);</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="recording-different-action-types">Recording Different Action Types<a href="#recording-different-action-types" class="hash-link" aria-label="Direct link to Recording Different Action Types" title="Direct link to Recording Different Action Types">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="click-actions">Click Actions<a href="#click-actions" class="hash-link" aria-label="Direct link to Click Actions" title="Direct link to Click Actions">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import io.github.jspinak.brobot.action.basic.click.ClickOptions;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ActionRecord clickRecord = new ActionRecord.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .setActionConfig(new ClickOptions.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .setClickType(ClickOptions.Type.DOUBLE)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .setNumberOfClicks(2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .setPauseBeforeMouseDown(100)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .setPauseAfterMouseUp(100)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .build())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .addMatch(new Match.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .setRegion(150, 250, 40, 20)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .setSimScore(0.92)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .build())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .setActionSuccess(true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">history.addSnapshot(clickRecord);</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="type-actions-with-text">Type Actions with Text<a href="#type-actions-with-text" class="hash-link" aria-label="Direct link to Type Actions with Text" title="Direct link to Type Actions with Text">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import io.github.jspinak.brobot.action.basic.type.TypeOptions;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ActionRecord typeRecord = new ActionRecord.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .setActionConfig(new TypeOptions.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .setPauseBeforeBegin(200)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .setPauseAfterEnd(100)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .build())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .setText(&quot;Hello World&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .setActionSuccess(true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">history.addSnapshot(typeRecord);</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="vanish-actions">Vanish Actions<a href="#vanish-actions" class="hash-link" aria-label="Direct link to Vanish Actions" title="Direct link to Vanish Actions">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import io.github.jspinak.brobot.action.basic.vanish.VanishOptions;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ActionRecord vanishRecord = new ActionRecord.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .setActionConfig(new VanishOptions.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .setWaitTime(5.0)  // seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        .build())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .setActionSuccess(true)  // Element disappeared</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .setDuration(3500)  // Vanished after 3.5 seconds</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">history.addSnapshot(vanishRecord);</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="integration-testing-setup">Integration Testing Setup<a href="#integration-testing-setup" class="hash-link" aria-label="Direct link to Integration Testing Setup" title="Direct link to Integration Testing Setup">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-configure-mock-execution">1. Configure Mock Execution<a href="#1-configure-mock-execution" class="hash-link" aria-label="Direct link to 1. Configure Mock Execution" title="Direct link to 1. Configure Mock Execution">​</a></h3>
<p>Enable mock mode in your test configuration:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># application-test.yml</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">brobot</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">mock</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">use-real-screenshots</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#36acaa">false</span><br></span></code></pre></div></div>
<p><strong>Note</strong>: ActionHistory persistence is handled by the Brobot Runner application, not the library itself. During live automation, the Runner captures and stores ActionRecords in its database. For testing, ActionHistory is maintained in memory or loaded from exported files.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-initialize-state-objects-with-actionhistory">2. Initialize State Objects with ActionHistory<a href="#2-initialize-state-objects-with-actionhistory" class="hash-link" aria-label="Direct link to 2. Initialize State Objects with ActionHistory" title="Direct link to 2. Initialize State Objects with ActionHistory">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import io.github.jspinak.brobot.model.state.stateObject.StateImage;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import io.github.jspinak.brobot.model.action.ActionHistory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Component</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class LoginStateInitializer {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public StateImage createLoginButton() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        StateImage loginButton = new StateImage.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .withPattern(&quot;login-button.png&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Add historical data for realistic mocking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ActionHistory history = new ActionHistory();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Simulate 90% success rate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; 100; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            boolean success = i &lt; 90;  // 90% success</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ActionRecord record = new ActionRecord.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setActionConfig(new PatternFindOptions.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .setStrategy(PatternFindOptions.Strategy.BEST)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .build())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setActionSuccess(success)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .addMatch(success ? createMatch() : null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            history.addSnapshot(record);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        loginButton.setActionHistory(history);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return loginButton;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private Match createMatch() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new Match.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .setRegion(500, 400, 100, 40)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .setSimScore(0.85 + Math.random() * 0.1)  // 0.85-0.95</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-write-integration-tests">3. Write Integration Tests<a href="#3-write-integration-tests" class="hash-link" aria-label="Direct link to 3. Write Integration Tests" title="Direct link to 3. Write Integration Tests">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import org.junit.jupiter.api.Test;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.boot.test.context.SpringBootTest;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import org.springframework.test.context.TestPropertySource;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@SpringBootTest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@TestPropertySource(properties = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;brobot.core.mock=true&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;brobot.action-history.source=database&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">})</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class LoginWorkflowIntegrationTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private LoginState loginState;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Autowired</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private ActionHistory actionHistory;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void testLoginWorkflow() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Pre-populate ActionHistory with realistic data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        prepareActionHistory();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Execute the workflow - will use ActionHistory for mocking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        boolean loginSuccess = loginState.execute();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertTrue(loginSuccess, &quot;Login should succeed based on ActionHistory&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Verify action was recorded</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertEquals(actionHistory.getTimesSearched(), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    actionHistory.getTimesFound() + 1);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private void prepareActionHistory() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Add successful login button click</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ActionRecord loginClick = new ActionRecord.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .setActionConfig(new ClickOptions.Builder().build())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .addMatch(new Match.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setRegion(500, 400, 100, 40)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setSimScore(0.92)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .build())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .setActionSuccess(true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        actionHistory.addSnapshot(loginClick);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Add successful username field interaction</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ActionRecord usernameType = new ActionRecord.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .setActionConfig(new TypeOptions.Builder().build())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .setText(&quot;testuser@example.com&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .setActionSuccess(true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        actionHistory.addSnapshot(usernameType);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="advanced-testing-patterns">Advanced Testing Patterns<a href="#advanced-testing-patterns" class="hash-link" aria-label="Direct link to Advanced Testing Patterns" title="Direct link to Advanced Testing Patterns">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="state-specific-actionhistory">State-Specific ActionHistory<a href="#state-specific-actionhistory" class="hash-link" aria-label="Direct link to State-Specific ActionHistory" title="Direct link to State-Specific ActionHistory">​</a></h3>
<p>Different states can have different success patterns:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class StateSpecificTesting {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void testStateTransitions() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Long loginStateId = 1L;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Long mainStateId = 2L;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Add state-specific records</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ActionRecord loginRecord = new ActionRecord.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .setActionConfig(new PatternFindOptions.Builder().build())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .setStateId(loginStateId)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .setActionSuccess(true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .addMatch(createLoginMatch())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ActionRecord mainRecord = new ActionRecord.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .setActionConfig(new PatternFindOptions.Builder().build())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .setStateId(mainStateId)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .setActionSuccess(true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .addMatch(createMainMatch())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        actionHistory.addSnapshot(loginRecord);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        actionHistory.addSnapshot(mainRecord);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Query state-specific snapshots</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Optional&lt;ActionRecord&gt; loginSnapshot = actionHistory.getRandomSnapshot(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new PatternFindOptions.Builder().build(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            loginStateId</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertTrue(loginSnapshot.isPresent());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertEquals(loginStateId, loginSnapshot.get().getStateId());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="simulating-failures">Simulating Failures<a href="#simulating-failures" class="hash-link" aria-label="Direct link to Simulating Failures" title="Direct link to Simulating Failures">​</a></h3>
<p>Test error handling with failure scenarios:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class FailureSimulation {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ActionHistory createFlakeyButtonHistory() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ActionHistory history = new ActionHistory();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Random random = new Random(42);  // Deterministic for testing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; 20; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            boolean success = random.nextDouble() &lt; 0.7;  // 70% success</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ActionRecord record = new ActionRecord.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setActionConfig(new ClickOptions.Builder().build())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setActionSuccess(success)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .addMatch(success ? createMatch() : null)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setDuration(success ? 200 : 5000)  // Timeout on failure</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            history.addSnapshot(record);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return history;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void testRetryMechanism() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        StateImage flakeyButton = new StateImage.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .withPattern(&quot;flakey-button.png&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        flakeyButton.setActionHistory(createFlakeyButtonHistory());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Test retry logic</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        int attempts = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        boolean success = false;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        while (!success &amp;&amp; attempts &lt; 3) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Optional&lt;ActionRecord&gt; result = flakeyButton.getActionHistory()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .getRandomSnapshot(new ClickOptions.Builder().build());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            success = result.map(ActionRecord::isActionSuccess).orElse(false);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            attempts++;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Should eventually succeed with retries</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertTrue(success || attempts == 3, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Should succeed with retries or reach max attempts&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="text-extraction-testing">Text Extraction Testing<a href="#text-extraction-testing" class="hash-link" aria-label="Direct link to Text Extraction Testing" title="Direct link to Text Extraction Testing">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class TextExtractionTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void testOCRResults() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ActionHistory ocrHistory = new ActionHistory();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Add OCR results with varying accuracy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String[] expectedTexts = {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Username:&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Password:&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;Login&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (String text : expectedTexts) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ActionRecord ocrRecord = new ActionRecord.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setActionConfig(new PatternFindOptions.Builder().build())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setText(text)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .addMatch(new Match.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .setRegion(100, 100 + ocrHistory.getSnapshots().size() * 50, 200, 30)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .setSimScore(0.95)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .build())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setActionSuccess(true)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ocrHistory.addSnapshot(ocrRecord);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Test random text retrieval</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String randomText = ocrHistory.getRandomText();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertTrue(Arrays.asList(expectedTexts).contains(randomText));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Test all texts are accessible</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Set&lt;String&gt; retrievedTexts = new HashSet&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; 100; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            retrievedTexts.add(ocrHistory.getRandomText());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertEquals(expectedTexts.length, retrievedTexts.size(),</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &quot;All texts should be retrievable&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="data-driven-testing">Data-Driven Testing<a href="#data-driven-testing" class="hash-link" aria-label="Direct link to Data-Driven Testing" title="Direct link to Data-Driven Testing">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="loading-actionhistory-from-files">Loading ActionHistory from Files<a href="#loading-actionhistory-from-files" class="hash-link" aria-label="Direct link to Loading ActionHistory from Files" title="Direct link to Loading ActionHistory from Files">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">import com.fasterxml.jackson.databind.ObjectMapper;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.file.Files;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import java.nio.file.Path;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class DataDrivenTests {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final ObjectMapper objectMapper = new ObjectMapper();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void testWithHistoricalData() throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Load pre-recorded ActionHistory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Path historyFile = Path.of(&quot;src/test/resources/action-histories/login-flow.json&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String json = Files.readString(historyFile);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ActionHistory history = objectMapper.readValue(json, ActionHistory.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Use historical data for testing</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        StateImage loginButton = new StateImage.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .withPattern(&quot;login.png&quot;)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        loginButton.setActionHistory(history);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Run tests with real historical data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Optional&lt;ActionRecord&gt; snapshot = history.getRandomSnapshot(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            new ClickOptions.Builder().build()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertTrue(snapshot.isPresent());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertTrue(snapshot.get().isActionSuccess());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void saveActionHistory(ActionHistory history, Path outputPath) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        String json = objectMapper.writerWithDefaultPrettyPrinter()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .writeValueAsString(history);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Files.writeString(outputPath, json);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="using-actionhistory-from-brobot-runner">Using ActionHistory from Brobot Runner<a href="#using-actionhistory-from-brobot-runner" class="hash-link" aria-label="Direct link to Using ActionHistory from Brobot Runner" title="Direct link to Using ActionHistory from Brobot Runner">​</a></h3>
<p>The Brobot Runner application provides persistence for ActionHistory:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// Export ActionHistory from Runner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 1. Run automation with recording enabled in Runner UI</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 2. Export session as JSON file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// 3. Load in your tests:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import com.fasterxml.jackson.databind.ObjectMapper;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@Service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class ActionHistoryLoader {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private final ObjectMapper objectMapper = new ObjectMapper();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ActionHistory loadFromRunnerExport(String filename) throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Path path = Path.of(&quot;test-data/runner-exports&quot;, filename);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return objectMapper.readValue(path.toFile(), ActionHistory.class);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Map&lt;String, ActionHistory&gt; loadAllExports() throws IOException {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Map&lt;String, ActionHistory&gt; histories = new HashMap&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Path exportDir = Path.of(&quot;test-data/runner-exports&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Files.list(exportDir)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .filter(p -&gt; p.toString().endsWith(&quot;.json&quot;))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .forEach(path -&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                try {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    String name = path.getFileName().toString().replace(&quot;.json&quot;, &quot;&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    histories.put(name, loadFromRunnerExport(path.getFileName().toString()));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                } catch (IOException e) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    log.error(&quot;Failed to load {}&quot;, path, e);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return histories;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p><strong>Workflow for Using Runner-Recorded Data:</strong></p>
<ol>
<li><strong>Record in Runner</strong>: Enable recording in the Runner UI during live automation</li>
<li><strong>Export Sessions</strong>: Export recorded sessions as JSON files</li>
<li><strong>Import in Tests</strong>: Load exported ActionHistory in your integration tests</li>
<li><strong>Replay Behavior</strong>: Use the recorded data for realistic mock testing</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="performance-testing">Performance Testing<a href="#performance-testing" class="hash-link" aria-label="Direct link to Performance Testing" title="Direct link to Performance Testing">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="measuring-action-performance">Measuring Action Performance<a href="#measuring-action-performance" class="hash-link" aria-label="Direct link to Measuring Action Performance" title="Direct link to Measuring Action Performance">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class PerformanceTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void testActionPerformance() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ActionHistory performanceHistory = new ActionHistory();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Simulate various response times</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; 100; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            long duration = 100 + (long)(Math.random() * 900);  // 100-1000ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ActionRecord record = new ActionRecord.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setActionConfig(new PatternFindOptions.Builder().build())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setDuration(duration)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setActionSuccess(duration &lt; 800)  // Timeout at 800ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            performanceHistory.addSnapshot(record);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Analyze performance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        double avgDuration = performanceHistory.getSnapshots().stream()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .mapToLong(ActionRecord::getDuration)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .average()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .orElse(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        long maxDuration = performanceHistory.getSnapshots().stream()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .mapToLong(ActionRecord::getDuration)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .max()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            .orElse(0);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertTrue(avgDuration &lt; 600, &quot;Average duration should be under 600ms&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertTrue(maxDuration &lt; 1000, &quot;Max duration should be under 1000ms&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="best-practices">Best Practices<a href="#best-practices" class="hash-link" aria-label="Direct link to Best Practices" title="Direct link to Best Practices">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-realistic-data-generation">1. Realistic Data Generation<a href="#1-realistic-data-generation" class="hash-link" aria-label="Direct link to 1. Realistic Data Generation" title="Direct link to 1. Realistic Data Generation">​</a></h3>
<p>Create ActionHistory that reflects real-world patterns:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class RealisticDataGenerator {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ActionHistory generateRealisticHistory() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ActionHistory history = new ActionHistory();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Random random = new Random();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Morning hours - higher success rate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int hour = 9; hour &lt; 12; hour++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            addHourlyData(history, hour, 0.95);  // 95% success</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Afternoon - slightly lower success</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int hour = 12; hour &lt; 17; hour++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            addHourlyData(history, hour, 0.85);  // 85% success</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Evening - degraded performance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int hour = 17; hour &lt; 20; hour++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            addHourlyData(history, hour, 0.70);  // 70% success</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return history;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private void addHourlyData(ActionHistory history, int hour, double successRate) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; 10; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            boolean success = Math.random() &lt; successRate;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ActionRecord record = new ActionRecord.Builder()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setActionConfig(new PatternFindOptions.Builder().build())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setActionSuccess(success)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .setTimestamp(LocalDateTime.now()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .withHour(hour)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    .withMinute(i * 6))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                .build();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            history.addSnapshot(record);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-isolation-between-tests">2. Isolation Between Tests<a href="#2-isolation-between-tests" class="hash-link" aria-label="Direct link to 2. Isolation Between Tests" title="Direct link to 2. Isolation Between Tests">​</a></h3>
<p>Ensure tests don&#x27;t interfere with each other:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@TestInstance(TestInstance.Lifecycle.PER_METHOD)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">public class IsolatedActionHistoryTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    private ActionHistory history;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @BeforeEach</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void setUp() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Fresh ActionHistory for each test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        history = new ActionHistory();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @AfterEach</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    void tearDown() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Clear any persistent data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        history = null;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-deterministic-testing">3. Deterministic Testing<a href="#3-deterministic-testing" class="hash-link" aria-label="Direct link to 3. Deterministic Testing" title="Direct link to 3. Deterministic Testing">​</a></h3>
<p>Use seeded random for reproducible tests:</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">public class DeterministicTest {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @RepeatedTest(5)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    public void testDeterministicBehavior() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Use fixed seed for reproducibility</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Random random = new Random(12345);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ActionHistory history = createSeededHistory(random);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Results should be identical across runs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        List&lt;Boolean&gt; results = new ArrayList&lt;&gt;();</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        for (int i = 0; i &lt; 10; i++) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Optional&lt;ActionRecord&gt; snapshot = history.getRandomSnapshot(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                new PatternFindOptions.Builder().build()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            results.add(snapshot.map(ActionRecord::isActionSuccess).orElse(false));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        // Verify deterministic pattern</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        assertEquals(Arrays.asList(true, true, false, true, true, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                  false, true, true, true, false), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    results);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="troubleshooting">Troubleshooting<a href="#troubleshooting" class="hash-link" aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="common-issues">Common Issues<a href="#common-issues" class="hash-link" aria-label="Direct link to Common Issues" title="Direct link to Common Issues">​</a></h3>
<ol>
<li><strong>Empty ActionHistory</strong>: Ensure snapshots are added before querying</li>
<li><strong>Type Mismatches</strong>: Use consistent ActionConfig types</li>
<li><strong>State Context</strong>: Verify state IDs match when using state-specific queries</li>
<li><strong>Text Snapshots</strong>: Text-only snapshots need matches added automatically</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="debug-logging">Debug Logging<a href="#debug-logging" class="hash-link" aria-label="Direct link to Debug Logging" title="Direct link to Debug Logging">​</a></h3>
<p>Enable detailed logging for troubleshooting:</p>
<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">logging</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">level</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">io.github.jspinak.brobot.model.action</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> DEBUG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">io.github.jspinak.brobot.mock</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> DEBUG</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="migration-from-legacy-api">Migration from Legacy API<a href="#migration-from-legacy-api" class="hash-link" aria-label="Direct link to Migration from Legacy API" title="Direct link to Migration from Legacy API">​</a></h2>
<p>If you have existing tests using <code>ActionOptions</code>, see the <a href="/brobot/docs/core-library/migration/actionhistory-migration-guide">ActionHistory Migration Guide</a> for detailed migration instructions.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="next-steps">Next Steps<a href="#next-steps" class="hash-link" aria-label="Direct link to Next Steps" title="Direct link to Next Steps">​</a></h2>
<ul>
<li>Learn about <a href="/brobot/docs/core-library/testing/enhanced-mocking">Enhanced Mocking</a> for advanced scenarios</li>
<li>Explore <a href="/brobot/docs/getting-started/states">States</a> for complex workflows</li>
<li>Read about <a href="/brobot/docs/getting-started/core-concepts">Core Concepts</a> for foundational understanding</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/jspinak/brobot/edit/main/docs/docs/04-testing/actionhistory-integration-testing.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/brobot/docs/testing/action-recording"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Action Recording</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/brobot/docs/testing/mixed-mode-execution"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Mixed-Mode Execution</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#understanding-actionhistory" class="table-of-contents__link toc-highlight">Understanding ActionHistory</a><ul><li><a href="#what-is-actionhistory" class="table-of-contents__link toc-highlight">What is ActionHistory?</a></li><li><a href="#key-components" class="table-of-contents__link toc-highlight">Key Components</a></li></ul></li><li><a href="#modern-api-usage" class="table-of-contents__link toc-highlight">Modern API Usage</a><ul><li><a href="#creating-actionhistory-with-actionconfig" class="table-of-contents__link toc-highlight">Creating ActionHistory with ActionConfig</a></li><li><a href="#recording-different-action-types" class="table-of-contents__link toc-highlight">Recording Different Action Types</a></li></ul></li><li><a href="#integration-testing-setup" class="table-of-contents__link toc-highlight">Integration Testing Setup</a><ul><li><a href="#1-configure-mock-execution" class="table-of-contents__link toc-highlight">1. Configure Mock Execution</a></li><li><a href="#2-initialize-state-objects-with-actionhistory" class="table-of-contents__link toc-highlight">2. Initialize State Objects with ActionHistory</a></li><li><a href="#3-write-integration-tests" class="table-of-contents__link toc-highlight">3. Write Integration Tests</a></li></ul></li><li><a href="#advanced-testing-patterns" class="table-of-contents__link toc-highlight">Advanced Testing Patterns</a><ul><li><a href="#state-specific-actionhistory" class="table-of-contents__link toc-highlight">State-Specific ActionHistory</a></li><li><a href="#simulating-failures" class="table-of-contents__link toc-highlight">Simulating Failures</a></li><li><a href="#text-extraction-testing" class="table-of-contents__link toc-highlight">Text Extraction Testing</a></li></ul></li><li><a href="#data-driven-testing" class="table-of-contents__link toc-highlight">Data-Driven Testing</a><ul><li><a href="#loading-actionhistory-from-files" class="table-of-contents__link toc-highlight">Loading ActionHistory from Files</a></li><li><a href="#using-actionhistory-from-brobot-runner" class="table-of-contents__link toc-highlight">Using ActionHistory from Brobot Runner</a></li></ul></li><li><a href="#performance-testing" class="table-of-contents__link toc-highlight">Performance Testing</a><ul><li><a href="#measuring-action-performance" class="table-of-contents__link toc-highlight">Measuring Action Performance</a></li></ul></li><li><a href="#best-practices" class="table-of-contents__link toc-highlight">Best Practices</a><ul><li><a href="#1-realistic-data-generation" class="table-of-contents__link toc-highlight">1. Realistic Data Generation</a></li><li><a href="#2-isolation-between-tests" class="table-of-contents__link toc-highlight">2. Isolation Between Tests</a></li><li><a href="#3-deterministic-testing" class="table-of-contents__link toc-highlight">3. Deterministic Testing</a></li></ul></li><li><a href="#troubleshooting" class="table-of-contents__link toc-highlight">Troubleshooting</a><ul><li><a href="#common-issues" class="table-of-contents__link toc-highlight">Common Issues</a></li><li><a href="#debug-logging" class="table-of-contents__link toc-highlight">Debug Logging</a></li></ul></li><li><a href="#migration-from-legacy-api" class="table-of-contents__link toc-highlight">Migration from Legacy API</a></li><li><a href="#next-steps" class="table-of-contents__link toc-highlight">Next Steps</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.youtube.com/watch?v=aHnVQ8KmOVw" target="_blank" rel="noopener noreferrer" class="footer__link-item">Introductory Video</a></li><li class="footer__item"><a class="footer__link-item" href="/brobot/docs/getting-started/introduction">Get Started</a></li><li class="footer__item"><a class="footer__link-item" href="/brobot/visualAPI">The Visual API</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/brobot" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/brobot/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/jspinak/brobot" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCgRljq-lHkMLrzRzpJC4HNw" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://search.maven.org/artifact/io.github.jspinak/brobot" target="_blank" rel="noopener noreferrer" class="footer__link-item">Maven Central<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2025 Joshua Spinak · Free & Open Source</div></div></div></footer></div>
</body>
</html>